<!doctype html>
<html>
  <head>
    <title>o2r Informer</title>
    <style>
    </style>
  </head>
  <body>
    <pre id="jobid" style="border: 1px solid blue;"></pre>
    <pre id="status" style="border: 1px solid black;"></pre>
    <pre id="log" style="border: 1px solid black;"></pre>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script>
      var socket = io('http://localhost:8082/api/v1/logs/job');
      socket.on('connect', function(data) {
        console.log('connected!');
      });
      function update(event) {
        // This will hold the Job ID the data relates to.
        document.getElementById("jobid").innerHTML = event["id"];
        // Only the changed fields will be transmitted in a event, so check for each. Can't be referred to as real objects yet.
        if(event["steps.image_execute.status"] !== undefined) {
          document.getElementById("status").innerHTML = event["steps.image_execute.status"];
        }
        if(event["steps.image_execute.text"] !== undefined) {
          document.getElementById("log").innerHTML = event["steps.image_execute.text"];
          window.scrollTo(0,document.body.scrollHeight);
        }
      }
      socket.on("document", update);
      socket.on("set", update);
    </script>
  </body>
</html>
